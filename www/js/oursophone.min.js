/*! oursophone 01-03-2015 */
var OursoPhone=OursoPhone||{};OursoPhone.cache={size:"",hsize:function(a){var b=-1,c=[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"];do a/=1024,b++;while(a>1024);return Math.max(a,.1).toFixed(1)+c[b]},lastWrite:null,lifeTime:86400,autoSaveFreq:10,autoSave:function(){null!==OursoPhone.cache.lastWrite&&(0- -OursoPhone.cache.lastWrite+1e3*OursoPhone.cache.autoSaveFreq<Date.now()||OursoPhone.cache.store())},store:function(){var a;OursoPhone.localStorage&&(console.info("freezing cache in localStorage"),a={user:{byid:OursoPhone.cache.user.byid,byusername:OursoPhone.cache.user.byusername,bypermalink:OursoPhone.cache.user.bypermalink},track:{byid:OursoPhone.cache.track.byid},trackList:{byuser:OursoPhone.cache.trackList.byuser,byalbum:OursoPhone.cache.trackList.byalbum},album:{byid:OursoPhone.cache.album.byid},tagList:{bytag:OursoPhone.cache.tagList.bytag},playList:{byuser:OursoPhone.cache.playList.byuser}},a.cached_at=Date.now(),a=JSON.stringify(a),localStorage.setItem("oursophone-cache",a),OursoPhone.cache.size=OursoPhone.cache.hsize(a.length),$("oursophone").attr("data-size",OursoPhone.cache.size))},restore:function(){var a;if(OursoPhone.localStorage){if(a=localStorage.getItem("oursophone-cache"),null===a)return;OursoPhone.cache.size=OursoPhone.cache.hsize(a.length),$("oursophone").attr("data-size",OursoPhone.cache.size),a=JSON.parse(a),null!==a&&(console.info("unfreezing cache from localStorage",a),OursoPhone.cache.user.byid=a.user.byid,OursoPhone.cache.user.byusername=a.user.byusername,OursoPhone.cache.user.bypermalink=a.user.bypermalink,OursoPhone.cache.track.byid=a.track.byid,OursoPhone.cache.trackList.byuser=a.trackList.byuser,OursoPhone.cache.trackList.byalbum=a.trackList.byalbum,OursoPhone.cache.album.byid=a.album.byid,OursoPhone.cache.tagList.bytag=a.tagList.bytag,OursoPhone.cache.playList.byuser=a.playList.byuser)}},clean:function(){OursoPhone.localStorage&&localStorage.removeItem("oursophone-cache")},stamp:function(a){return void 0===a.cached_at?(a.cached_at=Date.now(),OursoPhone.cache.lastWrite=a.cached_at,console.log("stamping obj",{obj:a,stamp:a.cached_at})):console.log("obj already stamped",{obj:a,stamp:a.cached_at}),a},user:{byid:{},byusername:{},bypermalink:{},store:function(a){void 0===OursoPhone.cache.user.byid[a.id]&&(a=OursoPhone.cache.stamp(a),["id","username","permalink"].forEach(function(b){var c="by"+b,d=a[b];d&&(OursoPhone.cache.user[c][d]=a)}))},find:function(a){return OursoPhone.cache.user.byid[a]?OursoPhone.cache.user.byid[a]:OursoPhone.cache.user.byusername[a]?OursoPhone.cache.user.byusername[a]:OursoPhone.cache.user.bypermalink[a]?OursoPhone.cache.user.bypermalink[a]:!1},fields:["id","kind","full_name","permalink_url","avatar_url","description","website","website_title","track_count","playlist_count","followers_count","followings_count"]},track:{byid:{},store:function(a){void 0===OursoPhone.cache.track.byid[a.id]&&(a=OursoPhone.cache.stamp(a),OursoPhone.cache.track.byid[a.id]=a)},find:function(a){return void 0!==OursoPhone.cache.track.byid[a]?OursoPhone.cache.track.byid[a]:!1}},trackList:{byuser:{},byalbum:{},store:function(a){void 0===OursoPhone.cache.trackList.byuser[a[0].user.id]&&(tracklist=OursoPhone.cache.stamp({tracks:a}),OursoPhone.cache.trackList.byuser[a[0].user.id]=tracklist,OursoPhone.cache.store())},find:function(a){return void 0!==OursoPhone.cache.trackList.byuser[a.id]?OursoPhone.cache.trackList.byuser[a.id].tracks:!1},fields:["id","title","uri","duration","commentable","description","artwork_url"]},album:{byid:{},store:function(a){void 0===OursoPhone.cache.album.byid[a.id]&&(a=OursoPhone.cache.stamp(a),OursoPhone.cache.album.byid[a.id]=a)},find:function(a){return OursoPhone.cache.album.byid[a]},fields:["id","kind","created_at","duration","track_count","genre","title","description","artwork_url"]},tagList:{bytag:{},store:function(a){var b;void 0===OursoPhone.cache.tagList.bytag[a.tag]&&(b=OursoPhone.cache.stamp({tracks:a.tracks}),OursoPhone.cache.tagList.bytag[a.tag]=b,OursoPhone.cache.store())},find:function(a){return void 0!==OursoPhone.cache.tagList.bytag[a]?OursoPhone.cache.tagList.bytag[a].tracks:!1}},playList:{byuser:{},store:function(a){var b;void 0===OursoPhone.cache.playList.byuser[a.userid]&&(b=OursoPhone.cache.stamp({albums:a.albums}),OursoPhone.cache.playList.byuser[a.userid]=b,OursoPhone.cache.store())},find:function(a){return void 0!==OursoPhone.cache.playList.byuser[a]?OursoPhone.cache.playList.byuser[a].albums:(console.warn("playlist not found for user:",a),!1)}}},OursoPhone.config={scClientID:"0ec3a92db08c758a47397bf8d588a250",scUserID:61698493,CORSRelay:!1,autoplay:!0,theme:"default",showComments:!1,loop:!0,isInWebView:!(!window._cordovaNative&&!window.__nwWindowId),isFeedbackEnabled:!1,gestureLoaded:!1,thumbs:{autoresize:!0,rowsperalbum:3,rowspertrack:4}},OursoPhone.initialPlay=!0,OursoPhone.currentPlayer=void 0,OursoPhone.currentTrack=void 0,OursoPhone.waveFormRenderer=void 0,OursoPhone.graphUpdater=void 0,OursoPhone.graphData={progress:0,chroma:"transparent"},OursoPhone.localStorage=!1,OursoPhone.waveformData=void 0,OursoPhone.waveformWidth=void 0,OursoPhone.pixelTrans="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",OursoPhone.templates=["index","album-goback","album-item","album-no-picture","album-picture","track-item","track-no-picture","track-picture","user-item","view-mode-control","comment-item"],OursoPhone.on={},OursoPhone.on.playerClick=function(a){return OursoPhone.config.isFeedbackEnabled&&OursoPhone.ui.vibrate(a),""!=$(this).attr("data-href")&&location.hash!=$(this).attr("data-href")&&(location.href=$(this).attr("data-href")),!1},OursoPhone.on.tagListLoaded=function(a){var b=$("#playlist");OursoPhone.currentTrackList=a,OursoPhone.cache.tagList.store({tag:b.attr("data-tag-id"),tracks:a}),b.find(".track").remove(),b.attr("data-album-id","0").attr("data-display-mode","list"),a.forEach(OursoPhone.ui.drawTracks),setTimeout(OursoPhone.on.tagInserted,300),$("trackbox").off().on("click",OursoPhone.on.playerClick),OursoPhone.config.isInWebView&&$("#playlist").attr("data-display-mode","thumb"),OursoPhone.utils.interfaceRelease(),OursoPhone.calcThumbsSize()},OursoPhone.on.trackListLoaded=function(a){var b=$("#playlist");console.log("trackListLoaded",{tracks:a}),OursoPhone.currentTrackList=a,OursoPhone.cache.trackList.store(a),b.find(".track").remove(),$(".album").remove(),b.attr("data-album-id","0").attr("data-display-mode","list"),a.forEach(OursoPhone.ui.drawTracks),setTimeout(OursoPhone.on.tagInserted,300),$("trackbox").off().on("click",OursoPhone.on.playerClick),OursoPhone.config.isInWebView&&$("#playlist").attr("data-display-mode","thumb"),OursoPhone.utils.interfaceRelease(),OursoPhone.calcThumbsSize()},OursoPhone.on.playlistLoaded=function(a){var b,c=$("#playlist");if(c.attr("data-album-id",a.id),OursoPhone.currentTrackList=a.tracks,c.find(".track").remove(),a.tracks.forEach(OursoPhone.ui.drawTracks),$(".album").remove(),[a].forEach(OursoPhone.ui.drawAlbum),setTimeout(OursoPhone.on.tagInserted,300),$("trackbox").off().on("click",OursoPhone.on.playerClick),$("albumbox").off().on("click",OursoPhone.on.playerClick),$("trackbox").removeClass("active"),$("#user-description .user-id").text()!=a.user.id){var d=OursoPhone.cache.user.find(a.user.id);d?OursoPhone.ui.drawUser(d):SC.get("/users/"+a.user.id,OursoPhone.ui.drawUser)}b=$('trackbox[data-index="'+c.attr("data-song-id")+'"]'),b.length&&(b.addClass("active"),OursoPhone.currentTrack&&OursoPhone.ui.drawTrackInfo(OursoPhone.currentTrack)),c.addClass("docked"),$(".display-mode-thumb").trigger("click"),OursoPhone.config.isInWebView&&$("#playlist").attr("data-display-mode","thumb"),OursoPhone.utils.interfaceRelease(),OursoPhone.calcThumbsSize()},OursoPhone.on.playlistsGet=function(a){var b=$("#playlist"),c=b.attr("data-album-id");b.attr("data-album-id","0"),OursoPhone.cache.playList.store({userid:OursoPhone.config.scUserID,albums:a}),$(".album").remove(),a.forEach(OursoPhone.ui.drawAlbum),$("albumbox").on("click",OursoPhone.on.playerClick),"0"!=c&&$('albumbox[data-index="'+c+'"]').addClass("active"),b.removeClass("docked"),OursoPhone.calcThumbsSize()},OursoPhone.on.streamReady=function(a){var b;OursoPhone.currentPlayer=a,$("#comments").empty(),void 0!==OursoPhone.graphUpdater&&(clearInterval(OursoPhone.graphUpdater),cancelAnimationFrame(OursoPhone.player.dataWaveformReady),$("#canvas-overlay").css("box-shadow","0 0 1px rgba(0, 255, 0, 0.4) inset")),OursoPhone.localStorage&&OursoPhone.initialPlay&&(b=localStorage.getItem("currentPlayerPosition"),b&&null!==b&&(console.info("resuming track at",b),OursoPhone.currentPlayer.position=b)),OursoPhone.initialPlay=!1,OursoPhone.player.applyVolume(),OursoPhone.graphUpdater=setInterval(OursoPhone.player.songProgress,500),OursoPhone.utils.interfaceRelease()},OursoPhone.on.streamFinished=function(){void 0!==OursoPhone.graphUpdater&&(clearInterval(OursoPhone.graphUpdater),cancelAnimationFrame(OursoPhone.player.dataWaveformReady),$("#canvas-overlay").css({"box-shadow":"0 0 1px rgba(0, 255, 0, 0.4) inset",opacity:1})),OursoPhone.localStorage&&(localStorage.removeItem("currentPlayerPosition"),OursoPhone.currentPlayer.position=0),OursoPhone.config.autoplay&&$('[data-action="forward"]').trigger("click")},OursoPhone.on.trackInfo=function(a,b){var c,d,e,f,g=OursoPhone.player.getCurrent(),h=null;return OursoPhone.config.showComments&&(h=OursoPhone.ui.drawComment),null!==b?(console.warn("Error while loading track",b),$("#playlist").attr("data-album-id","0").attr("data-song-id","0"),location.href="#",void OursoPhone.utils.interfaceRelease()):($("#playlist").attr("data-song-id",a.id),OursoPhone.currentTrack=a,OursoPhone.ui.drawTrackInfo(a),$("trackbox").removeClass("active"),$('trackbox[data-index="'+a.id+'"]').addClass("active"),$(".display-mode-trackview").trigger("click"),g&&g.pause(),SC.stream("/tracks/"+a.id,{autoPlay:!0,usePeakData:!0,useWaveformData:!0,useEQData:!0,ontimedcomments:h,onloadedmetadata:function(a){console.log("loaded metadata",this,a)},onbufferchange:function(){},whileloading:function(){},whileplaying:function(){void 0===this._a.onaudioprocessattached&&(this._a.onaudioprocessattached=!0)}},OursoPhone.on.streamReady),f=OursoPhone.cache.user.find(a.user.id),f?OursoPhone.ui.drawUser(f):SC.get("/users/"+a.user.id,OursoPhone.ui.drawUser),d=$("#canvas-overlay"),e=d.find("img"),e.length<=0&&(e=$('<img class="waveform-img" />'),d.append(e)),e.on("error",function(){e.attr("src",OursoPhone.pixelTrans)}),e.on("load",function(){OursoPhone.waveformWidth=$(this).width()}),e.attr("src",a.waveform_url).removeClass("loader"),OursoPhone.config.isInWebView?(c=a.waveform_url.replace("http://w1","http://wis"),c=a.waveform_url.replace("https://w1","https://wis")):(c=a.waveform_url.replace("http://w1","http://wis"),c=a.waveform_url.replace("https://w1","https://wis"),OursoPhone.config.CORSRelay!==!1&&(c=a.waveform_url.replace("http://w1","wis"),c=a.waveform_url.replace("https://w1","wis"),c=OursoPhone.config.CORSRelay+"?w="+c)),void(c&&$.get(c,OursoPhone.player.animateWaveformData)))},OursoPhone.on.userResolved=function(a){a.id&&(OursoPhone.config.scUSerID=a.id,location.href="#user:"+a.id)},OursoPhone.on.tagInserted=function(){$("tag").off().on("click",function(){var a=$(this).text().replace(/[^a-z0-9 ]+/gi,"");return""!=a?(a=a.toLowerCase(),location.href="#tag:"+a,!1):void 0})},OursoPhone.loadTemplates=function(){var a=OursoPhone.templates.shift();void 0!==a?TemplateStore.load(a,OursoPhone.loadTemplates):OursoPhone.start()},OursoPhone.start=function(){var a;TemplateStore.init(),a=TemplateStore.get("index").replaceArray(["{pixel-trans}"],[OursoPhone.pixelTrans]),$(a).appendTo("body"),window.onhashchange=OursoPhone.onRouteChanged,OursoPhone.onRouteChanged(),OursoPhone.ui.init()},OursoPhone.onRouteChanged=function(){var a=location.hash.replace("#","").split(":");return 2==a.length?void Route.list.dispatch(a):4==a.length?void Route.play.dispatch(a):void Route["default"](a)},OursoPhone.init=function(a){a&&(console.log("merging options",OursoPhone.config,a),OursoPhone.config=$.extend(OursoPhone.config,a));try{localStorage.setItem("blah","blah"),localStorage.removeItem("blah"),OursoPhone.localStorage=!0}catch(b){}OursoPhone.localStorage&&(a=JSON.parse(localStorage.getItem("oursophone-config")),null!==a&&(OursoPhone.config=$.extend(OursoPhone.config,a)),OursoPhone.cache.restore(),setInterval(OursoPhone.cache.autoSave,1e3*OursoPhone.cache.autoSaveFreq)),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(OursoPhone.config.isFeedbackEnabled=!0,OursoPhone.ui.vibrate=function(){navigator.vibrate(100)}),OursoPhone.config.isInWebView?(OursoPhone.config.thumbs.autoresize=!1,OursoPhone.config.theme="mobile",OursoPhone.config.gestureLoaded=!0,OursoPhone.config.isFeedbackEnabled=window.plugins&&window.plugins.deviceFeedback?!0:!1,OursoPhone.ui.vibrate=function(){DF=window.plugins.deviceFeedback,DF.haptic(DF.VIRTUAL_KEY)}):OursoPhone.config.thumbs.autoresize&&($(window).on("resize",function(){OursoPhone.lastResize=Date.now()}),setInterval(function(){Date.now()-OursoPhone.lastResize<300||0===OursoPhone.lastResize||($("#flex-box").scrollTop(0),OursoPhone.calcThumbsSize(),OursoPhone.lastResize=0)},300)),String.prototype.replaceArray=function(a,b){for(var c,d=this,e=0;e<a.length;e++)c=new RegExp(a[e],"g"),d=d.replace(c,b[e]);return d};var c=function(){var a=new XMLHttpRequest;a.open("HEAD",document.location.pathname,!1),a.send(null);var b=a.getAllResponseHeaders().toLowerCase();return!!/php/i.test(b)},d=function(){var a=new XMLHttpRequest;a.open("GET",document.location.pathname,!1),a.send(null);var b=a.getAllResponseHeaders().toLowerCase();return!!/ruby/i.test(b)};return c()?OursoPhone.config.CORSRelay=document.location.pathname:d()?OursoPhone.config.CORSRelay=document.location.pathname:$("#canvas-overlay").addClass("no-colors"),OursoPhone.loadTheme(function(){try{OursoPhone.start()}catch(a){OursoPhone.loadTemplates()}}),this},OursoPhone.loadTheme=function(a){return/^[a-z0-9_\-]+$/i.test(OursoPhone.config.theme)?($('style[id^="oursophone-theme"]').remove(),void $.ajax({url:"css/oursophone.theme."+OursoPhone.config.theme+".css",dataType:"text",success:function(b){$('<style type="text/css" id="oursophone-theme-'+OursoPhone.config.theme+'">\n'+b+"</style>").appendTo("head"),a()},error:function(){console.warn("invalid theme in OursoPhone.config.theme: ",OursoPhone.config.theme),a()}})):void a()},OursoPhone.player={},OursoPhone.player.stop=function(){OursoPhone.currentPlayer.stop(),OursoPhone.currentPlayer.position=0,OursoPhone.localStorage&&localStorage.removeItem("currentPlayerPosition"),clearInterval(OursoPhone.graphUpdater),$("#player-state").attr({"class":"","data-state":""})},OursoPhone.player.pause=function(){var a=OursoPhone.player.getCurrent();a?a.paused===!1?a.pause():console.warn("received blind pause"):console.warn("received early pause"),cancelAnimationFrame(OursoPhone.player.dataWaveformReady),OursoPhone.localStorage&&localStorage.removeItem("currentPlayerPosition"),OursoPhone.utils.interfaceRelease()},OursoPhone.player.play=function(){var a=OursoPhone.player.getCurrent();a?a.paused===!0?(a.play(),console.warn("sending play")):console.warn("received blind play, expecting paused=true and got paused=",a.paused):console.warn("received early play"),OursoPhone.utils.interfaceRelease()},OursoPhone.player.next=function(){function a(a){for(var b in a)return b}var b,c,d,e=!1;return OursoPhone.player.stop(),OursoPhone.currentTrackList&&OursoPhone.currentTrackList.length?(b=$("#playlist"),c={tag:b.attr("data-tag-id"),user:b.attr("data-user"),album:b.attr("data-album-id")},d=b.attr("data-song-id"),OursoPhone.currentTrackList.forEach(function(b,f){var g,h,i="",j="";if("0"!=c.tag?(i="tag",j=c.tag):""!=c.user?(i="user",j=c.user):(i="album",j=c.album),b.id==d)if(h=OursoPhone.currentTrackList,f+1<OursoPhone.currentTrackList.length)void 0!==h[f+1].id&&null!==h[f+1].id&&(e="#"+i+":"+j+":track:"+h[f+1].id);else if(OursoPhone.config.loop)switch(i){case"album":g=OursoPhone.cache.playList.byuser[OursoPhone.config.scUserID].albums,g.forEach(function(b,c){var d;b.id==j&&(c+1<g.length?e="#"+i+":"+g[c+1].id+":track:"+g[c+1].tracks[0].id:(d=g[a(g)],e="#"+i+":"+d.id+":track:"+d.tracks[0].id))});break;default:e="#"+i+":"+j+":track:"+OursoPhone.currentTrackList[0].id}}),void(e?location.href=e:(console.log("no next track found"),location.href="#",OursoPhone.utils.interfaceRelease()))):(console.warn("current tracklist is empty"),void OursoPhone.utils.interfaceRelease())},OursoPhone.player.prev=function(){var a,b,c,d=!1;return OursoPhone.player.stop(),OursoPhone.currentTrackList.length?(a=$("#playlist"),b={tag:a.attr("data-tag-id"),user:a.attr("data-user"),album:a.attr("data-album-id")},c=a.attr("data-song-id"),OursoPhone.currentTrackList.forEach(function(a,e){var f="",g="";0!=b.tag?(f="tag",g=b.tag):""!=b.user?(f="user",g=b.user):(f="album",g=b.album),a.id==c&&e-1>=0&&void 0!==OursoPhone.currentTrackList[e-1].id&&null!==OursoPhone.currentTrackList[e-1].id&&(d="#"+f+":"+g+":track:"+OursoPhone.currentTrackList[e-1].id)}),void(d?location.href=d:OursoPhone.utils.interfaceRelease())):void OursoPhone.utils.interfaceRelease()},OursoPhone.player.applyVolume=function(){$('input[data-action="setvolume"]').trigger("change")},OursoPhone.player.setVolume=function(a){var b=OursoPhone.player.getCurrent();void 0===b?console.warn("attempt to change volume on undefined player",a):b.setVolume(a)},OursoPhone.player.getCurrent=function(){return OursoPhone.currentPlayer},OursoPhone.player.getWaveFormData=function(){return OursoPhone.waveformData},OursoPhone.player.setWaveformData=function(a){OursoPhone.waveformData=a},OursoPhone.player.animateWaveformData=function(a){var b;void 0!==a?(cancelAnimationFrame(OursoPhone.player.dataWaveformReady),clearInterval(OursoPhone.player.dataWaveformReady),OursoPhone.player.setWaveformData(a),b=(OursoPhone.currentTrack.duration/18e4*100).toFixed(0),OursoPhone.waveFormRenderer="setInterval",setInterval(OursoPhone.player.dataWaveformReady,b),OursoPhone.currentTrack.duration>18e4?$("#animbox").css("transition","all "+b+"ms cubic-bezier(0.5, -0.5, 0.5, 1.5) 0s"):$("#animbox").css("transition","all 0.1s ease 0s")):alert("dahoops")},OursoPhone.player.dataWaveformReady=function(){var a,b,c,d,e=OursoPhone.player.getCurrent(),f=OursoPhone.player.getWaveFormData();if(void 0!==e&&void 0!==f){var g=e.position/e.duration,h=g*OursoPhone.waveformWidth,i=(1800*g).toFixed(0),j=0;j=f.samples[i]/f.height,b=255-(255*j).toFixed(0),c=(255*j).toFixed(0),d=255-(255*j).toFixed(0),a="rgb("+b+","+c+","+d+")",document.getElementById("animbox").style.height=f.samples[i]+"px",document.getElementById("animbox").style.backgroundColor=a,OursoPhone.graphData={chroma:a,ratio:g,progress:h}}"requestAnimationFrame"==OursoPhone.waveFormRenderer&&requestAnimationFrame(OursoPhone.player.dataWaveformReady)},OursoPhone.player.songProgress=function(){var a,b=OursoPhone.player.getCurrent();void 0!==b&&(1===OursoPhone.graphData.ratio?OursoPhone.on.streamFinished():$("#canvas-overlay").css({"box-shadow":OursoPhone.graphData.progress.toFixed(0)+"px 0 1px "+OursoPhone.graphData.chroma+" inset"}),a=1===b.playState?"playing":a,a=b.isBuffering===!0?"loading":a,a=b.paused===!0?"paused":a,OursoPhone.localStorage&&("playing"==a?localStorage.setItem("currentPlayerPosition",b.position):localStorage.setItem("currentPlayerPosition",null)),$("#player-state,#controls").attr({"class":a,"data-state":a}))};var Route={"default":function(){var a,b,c=$("#playlist");c.attr("data-album-id",0).attr("data-tag-id",0).attr("data-user",""),b=OursoPhone.cache.playList.find(OursoPhone.config.scUserID),b?OursoPhone.on.playlistsGet(b):SC.get("/users/"+OursoPhone.config.scUserID+"/playlists",OursoPhone.on.playlistsGet),a=OursoPhone.cache.user.find(OursoPhone.config.scUserID),a?OursoPhone.ui.drawUser(a):SC.get("/users/"+OursoPhone.config.scUserID,OursoPhone.ui.drawUser)},list:{dispatch:function(a){switch(a[0]){case"album":Route.list.albumdispatch(a);break;case"tag":Route.list.tagdispatch(a);break;case"user":Route.list.userdispatch(a)}},albumdispatch:function(a){return/^[0-9]+$/gi.test(a[1])&&0!=a[1]?void Route.list.album(a):void console.warn("Route: bad hash entry")},tagdispatch:function(a){return/^[a-z0-9 ]+$/i.test(a[1])&&"0"!=a[1]?void Route.list.tag(a):void console.warn("Route: bad hash entry")},userdispatch:function(a){return/^[a-z0-9 _\-]+$/gi.test(a[1])&&""!=a[1]&&"0"!=a[1]?void Route.list.user(a):void console.warn("Route: bad user name")},album:function(a){var b,c,d=$("#playlist");a[1]!=d.attr("data-album-id")&&(d.attr("data-tag-id",0),d.attr("data-user",""),d.attr("data-album-id",a[1]),c=OursoPhone.cache.playList.find(OursoPhone.config.scUserID),c?OursoPhone.on.playlistsGet(c):SC.get("/users/"+OursoPhone.config.scUserID+"/playlists",OursoPhone.on.playlistsGet),b=OursoPhone.cache.album.find(a[1]),b?OursoPhone.on.playlistLoaded(b):SC.get("/playlists/"+a[1],OursoPhone.on.playlistLoaded))},tag:function(a){var b,c=$("#playlist");c.attr("data-tag-id")!=a[1]&&(c.attr("data-album-id",0).find(".album").remove(),c.attr("data-tag-id",a[1]),b=OursoPhone.cache.tagList.find(a[1]),b?OursoPhone.on.tagListLoaded(b):SC.get("/tracks/",{tags:a[1],filter:"streamable",order:"created_at"},OursoPhone.on.tagListLoaded))},user:function(a){var b,c,d=$("#playlist");d.attr("data-user")!=a[1]&&($("#playlist").attr("data-user",a[1]),b=OursoPhone.cache.user.find(a[1]),b?OursoPhone.ui.drawUser(b):SC.get("/users/"+a[1],OursoPhone.ui.drawUser),c=OursoPhone.cache.trackList.find({id:a[1]}),c?OursoPhone.on.trackListLoaded(c):SC.get("/users/"+a[1]+"/tracks",OursoPhone.on.trackListLoaded))}},play:{dispatch:function(a){if(!/^[a-z0-9 ]+$/i.test(a[1]))return void console.warn("Route: bad hash entry");if(!/^[0-9]+$/.test(a[3]))return void console.warn("Route: bad hash entry");switch(a[0]){case"album":Route.list.album(a);break;case"tag":Route.list.tag(a);break;case"user":Route.list.user(a)}a[3]!=$("#playlist").attr("data-song-id")&&a[3]!=$('#track-description trackbox[data-id="'+a[3]+'"]').attr("data-id")&&Route.play.song(a)},song:function(a){OursoPhone.utils.interfaceLock(),$("#playlist").attr("data-song-id",a[3]),SC.get("/tracks/"+a[3],OursoPhone.on.trackInfo)}}},TemplateStore={config:{folder:"templates/",extension:"tpl"},nl2br:function(a,b){var c=b||"undefined"==typeof b?"<br />":"<br>";return(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+c+"$2")},init:function(a){var b=document.querySelectorAll('script[type="text/html"]');if(0===b.length)return"Early TemplateStore:init() call, aborting";for(var c in b)void 0!==b[c].id&&(console.info("loading template ",b[c].id),TemplateStore.get(b[c].id));a&&a()},get:function(a){var b;return void 0!==TemplateStore.store[a]?TemplateStore.store[a]:(b=document.querySelector("#"+a),b?(TemplateStore.store[a]=b.innerHTML,b.parentElement.removeChild(b),TemplateStore.store[a]):(console.warn("no such tpl, use TemplateStore::load() first"),""))},load:function(a,b){var c=TemplateStore.config.folder+a+"."+TemplateStore.config.extension;$.get(c,function(c){$('<script type="text/html" id="'+a+'"></script>').html(c).appendTo("body"),b&&b()})},store:{}};OursoPhone.ui={},OursoPhone.ui.init=function(){var a=TemplateStore.get("view-mode-control");$(a).appendTo("#controls"),$("oursophone").attr("data-size",OursoPhone.cache.size),$(".display-mode-box div").off().on("click",function(a){var b,c,d=this.className.split("-")[2],e=$(this),f=$("#playlist");switch(OursoPhone.config.isFeedbackEnabled&&OursoPhone.ui.vibrate(a),OursoPhone.ui.touchRipple(a,this,$(this)),d){case"albumview":case"trackview":case"userview":if(e.hasClass("view-active"))return f.removeClass("docked"),console.log("view already set"),!1;if(console.log("wat"),b=$("#"+d.replace("view","")+"-description"),b.is(":empty"))return console.log("no need to scroll to an empty slot"),f.removeClass("docked"),!1;console.log("wot"),c=$("#flex-box"),c.animate({opacity:.5},100,function(){console.log("wut"),c.scrollTo(b,0,function(){c.animate({opacity:1},100,function(){})})}),$(".display-mode-box div").removeClass("view-active"),e.addClass("view-active"),f.removeClass("docked");break;case"up":$(".display-mode-albumview").trigger("click"),location.href="#";break;case"thumb":setTimeout(function(){OursoPhone.calcThumbsSize({maxrows:OursoPhone.config.thumbs.rowspertrack,containerSelector:"#playlist",quantifierSelector:"trackbox",outerThumbSelector:".track img",innerThumbSelector:".track",marginWidthRule:'[data-display-mode="thumb"] .track .track-picture',fontSizeRule:'[data-display-mode="thumb"] .track .track-title'})},300);case"list":$("#playlist[data-display-mode]").attr("data-display-mode",d),$(".display-mode-box div").removeClass("mode-active"),e.addClass("mode-active"),f.is(":empty")?f.removeClass("docked"):f.addClass("docked")}return!1}),$("#canvas-overlay").on("mousedown",function(a){var b,c,d,e;OursoPhone.config.isFeedbackEnabled&&OursoPhone.ui.vibrate(a),b=(a.pageX-$(this).offset().left)/$(this).width(),c=OursoPhone.player.getCurrent(),c&&(d=c.duration,e=(d*b).toFixed(0),c.setPosition(e))}),$(".search-button").on("click",function(){var a;(a=prompt("Load playlist from user : "))&&OursoPhone.ui.resolveUser(a)}),$('input[data-action="setvolume"]').on("change",function(){var a=$(this).val();OursoPhone.config.currentVolume=a,OursoPhone.player.setVolume(100*a),OursoPhone.localStorage&&(console.info("saving config"),localStorage.setItem("oursophone-config",JSON.stringify(OursoPhone.config)))}),OursoPhone.config.currentVolume&&$('input[data-action="setvolume"]').val(OursoPhone.config.currentVolume),$("#controls .player-button").on("click",function(a){var b=$(this);return OursoPhone.config.isFeedbackEnabled&&OursoPhone.ui.vibrate(a),OursoPhone.ui.touchRipple(a,this,$(this).find("span"),function(){switch(OursoPhone.utils.interfaceLock(),b.attr("data-action")){case"play":OursoPhone.player.play();break;case"pause":OursoPhone.player.pause();break;case"backward":OursoPhone.player.prev();break;case"forward":OursoPhone.player.next()}}),a.preventDefault(),!1}),$("#un-mute").on("click",function(a){OursoPhone.config.isFeedbackEnabled&&OursoPhone.ui.vibrate(a),OursoPhone.config.showComments=this.checked,OursoPhone.localStorage&&(console.info("saving config"),localStorage.setItem("oursophone-config",JSON.stringify(OursoPhone.config)))}),$("#un-mute").attr("checked",OursoPhone.config.showComments),$(".volume-control label").on("click",function(a){OursoPhone.config.isFeedbackEnabled&&OursoPhone.ui.vibrate(a);var b,c=$('[data-action="setvolume"]'),d=0- -c.val(),e=0- -c.prop("max"),f=0- -c.prop("min"),g=0- -c.prop("step");switch($(this).attr("data-volume-action")){case"+":e>=d+g&&(b=d+0+g);break;case"-":d-g>=f&&(b=d-g)}void 0!==b&&c.val(b).trigger("change")}),$("#flex-box").on("scroll",function(){{var a=$(this),b=a.offset().top;this.scrollTop}$("div[id$=description]").not(":empty").each(function(){var a;$(this).offset().top==b&&(a=this.id.split("-")[0],$(".display-mode-box div").removeClass("view-active"),$(".display-mode-"+a+"view").addClass("view-active"))})}).trigger("scroll"),setTimeout(function(){OursoPhone.calcThumbsSize()},500)},OursoPhone.ui.touchRipple=function(a,b,c,d){var e,f=a.pageX,g=a.pageY,h=$(b),i=g-h.offset().top,j=f-h.offset().left,k=parseInt(j),l=parseInt(i);(isNaN(k)||isNaN(l))&&(k=10,l=10),c.append('<svg><circle cx="'+k+'" cy="'+l+'" r="0"></circle></svg>'),e=$(c).find("circle"),e.animate({r:h.outerWidth()},{duration:300,step:function(a){e.attr("r",a)},complete:function(){e.attr("r",0),h.find("svg").remove(),d&&d()}})},OursoPhone.ui.drawAlbum=function(a){var b,c,d=TemplateStore.get("album-item"),e="";return a.streamable!==!0?void console.warn("album is not sreamable",a):"all"!==a.embeddable_by?void console.warn("album is not embeddable",a):(OursoPhone.cache.album.store(a),OursoPhone.cache.album.fields.forEach(function(b){if(void 0==a[b]||null==a[b]||""==a[b])switch(b){case"full_name":a[b]=a.username;break;default:a[b]=""}}),a.downloadable===!0,b=null!=a.artwork_url&&a.artwork_url.length>0?TemplateStore.get("album-picture").replaceArray(["{album-cover}"],[a.artwork_url]):'<img src="'+OursoPhone.pixelTrans+'" />',c=""==a.tag_list?"":"<tag>"+a.tag_list.match(/(".*?")|(\S+)/g).join("</tag><tag>")+"</tag>",e=d.replaceArray(["{album-kind}","{album-createdat}","{album-duration}","{album-taglist}","{album-trackcount}","{album-genre}","{album-url}","{album-index}","{album-title}","{album-description}","{album-cover}","{album-picture}"],[a.kind,a.created_at,new Date(a.duration).getMinutes()+"mn"+new Date(a.duration).getSeconds()%60+"s",c,a.track_count,a.genre,"#album:"+a.id,a.id,a.title,TemplateStore.nl2br(a.description),a.artwork_url,b]),$(e).appendTo("#album-description"),void setTimeout(OursoPhone.on.tagInserted,300))},OursoPhone.ui.drawTracks=function(a){var b,c="",d=TemplateStore.get("track-item"),e="",f="",g="",h="";return OursoPhone.cache.track.store(a),0!=$("#playlist").attr("data-tag-id")?(f="tag",g=$("#playlist").attr("data-tag-id")):""!=$("#playlist").attr("data-user")?(f="user",g=$("#playlist").attr("data-user")):(f="album",g=$("#playlist").attr("data-album-id")),a.streamable!==!0?void console.warn("track is not sreamable",a):"all"!==a.embeddable_by?void console.warn("track is not embeddable",a):(a.downloadable===!0,void 0===a.download_url&&(a.download_url=""),null===a.track_type&&(a.track_type=""),OursoPhone.cache.trackList.fields.forEach(function(b){c+="data-"+b+'="'+OursoPhone.utils.attrEncode(a[b])+'" '}),b=null!=a.artwork_url&&a.artwork_url.length>0?TemplateStore.get("track-picture").replaceArray(["{track-artwork-url}","{track-title}"],[a.artwork_url,OursoPhone.utils.htmlEncode(a.title)]):'<img src="'+OursoPhone.pixelTrans+'" />',h=""==a.tag_list?"":"<tag>"+a.tag_list.match(/(".*?")|(\S+)/g).join("</tag><tag>")+"</tag>",e=d.replaceArray(["{track-createdat}","{track-duration}","{track-taglist}","{track-genre}","{track-description}","{track-tracktype}","{track-permalinkurl}","{track-download-url}","{album-url}","{data-attributes}","{data-index}","{track-picture}","{track-title}"],[a.created_at,new Date(a.duration).getMinutes()+"mn"+new Date(a.duration).getSeconds()%60+"s",h,a.genre,TemplateStore.nl2br(a.description),a.track_type,a.permalink_url,a.download_url,"#"+f+":"+g+":track:"+a.id,c,a.id,b,OursoPhone.utils.htmlEncode(a.title)]),void $(e).appendTo("#playlist"))},OursoPhone.ui.drawTrackInfo=function(a){var b,c;return c=$('#playlist trackbox[data-index="'+a.id+'"]').clone(),c.length||(OursoPhone.ui.drawTracks(a),b=$('#playlist trackbox[data-index="'+a.id+'"]').parent(),c=b.find("trackbox").clone(),b.remove()),a.streamable!==!0?void console.warn("track is not sreamable",a):"all"!==a.embeddable_by?void console.warn("track is not embeddable",a):($(c).addClass("full-view").removeClass("active"),$("#track-description").html("").append(c),OursoPhone.config.isInWebView&&$(c).find(".track-titlespan").on("click",function(){var a=$(this).attr("data-download-url"),b=$(this).text();console.log(a);var c=function(a){alert("An error has occurred: Code = "+a.code),console.log("upload error source "+a.source),console.log("upload error target "+a.target)};window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(d){d.root.getFile("dummy.html",{create:!0,exclusive:!1},function(c){var d=c.toURL().replace("dummy.html",""),e=new FileTransfer;e.onprogress=function(a){a.loaded/a.total},c.remove();var f=encodeURI(a+"?client_id="+OursoPhone.config.scClientID);console.log("will download",f,d),e.download(f,d+b,function(a){console.log("download complete: "+a.toURL(),a,this)},function(a){console.log("download error source "+a.source),console.log("download error target "+a.target),console.log("upload error code: "+a.code)})},c)},c)}),void setTimeout(OursoPhone.on.tagInserted,300))},OursoPhone.ui.drawComment=function(a){var b,c,d=a[0];OursoPhone.config.showComments&&($('#comments li[data-id="'+d.id+'"]').length||(b=TemplateStore.get("comment-item").replaceArray(["{src}","{alt}","{title}","{target}","{href}","{comment}","{timestamp}"],[d.user.avatar_url,d.user.username,d.user.username,"_self","#user:"+d.user.id,d.body,"(@"+Math.floor(d.timestamp/1e3)+"s): "]),$(b).on("click",function(a){return OursoPhone.config.isFeedbackEnabled&&OursoPhone.ui.vibrate(a),OursoPhone.ui.resolveUser(d.user.id,!1),!1
}).appendTo("#comments")),c=$("#comments"),c.stop(!0,!0).animate({scrollTop:c.prop("scrollHeight")},300))},OursoPhone.ui.handleResolvedUser=function(a,b){b?(console.log("HTTP Error",b),alert("User not found")):a.id?(OursoPhone.cache.user.store(a),OursoPhone.on.userResolved(a)):console.warn("handleResolvedUser: nothing found")},OursoPhone.ui.handleResolveError=function(a){a.errors?(console.warn("HTTP Error while resolving user: user does not exists",a.errors),alert("User not found")):a.length>0?(OursoPhone.currentTrackList=a,OursoPhone.cache.trackList.store(a),$("#playlist").attr("data-tag-id","0"),$("#playlist").attr("data-album-id","0"),OursoPhone.on.userResolved({id:a[0].user_id})):console.warn("User has an empty track list")},OursoPhone.ui.resolveUser=function(a,b){var c=OursoPhone.cache.user.find(a);if(c){if(b===!1)return void OursoPhone.ui.drawUser(c);if(tracksIncache=OursoPhone.cache.trackList.find(c),tracksIncache)return $("#playlist").attr("data-tag-id","0"),$("#playlist").attr("data-album-id","0"),$("#playlist").attr("data-user",c.id),void OursoPhone.on.trackListLoaded(tracksIncache)}/^[a-z0-9 _\-]+$/gi.test(a)?b!==!1?SC.get("/users/"+a+"/tracks",{filter:"streamable",order:"created_at"},OursoPhone.ui.handleResolveError):SC.get("/users/"+a,OursoPhone.ui.drawUser):(console.log("will resolve",a),a=a.replace(/ /g,"-"),SC.get("/resolve",{url:"https://soundcloud.com/"+a},OursoPhone.ui.handleResolvedUser))},OursoPhone.ui.drawUser=function(a){var b=TemplateStore.get("user-item"),c=$("#user-description"),d="";OursoPhone.cache.user.store(a),OursoPhone.cache.user.fields.forEach(function(b){if(void 0==a[b]||null==a[b]||""==a[b])switch(b){case"full_name":a[b]=a.username;break;default:a[b]=""}}),d=b.replaceArray(["{user-id}","{user-kind}","{user-fullname}","{user-permalinkurl}","{user-avatarurl}","{user-description}","{user-website}","{user-websitetitle}","{user-trackcount}","{user-playlistcount}","{user-followerscount}","{user-followingcount}"],[a.id,a.kind,a.full_name,a.permalink_url,a.avatar_url,TemplateStore.nl2br(a.description),a.website,a.website_title,a.track_count,a.playlist_count,a.followers_count,a.followings_count]),c.removeClass("contracted").html(d),c.trigger("init"),c.find(".user-playlistcount").on("click",function(){return parseInt($(this).text())<=0?!1:(OursoPhone.config.scUserID=$(this).attr("data-user-id"),void(location.href="#"))}),OursoPhone.config.gestureLoaded},OursoPhone.utils={},OursoPhone.utils.htmlEncode=function(a){return a=null===a?"":a.toString(),a=$("<div/>").text(a).html(),a.replace(/\n/gi,"<br />\n")},OursoPhone.utils.attrEncode=function(a){return a=null===a?"":a.toString(),a=a.replace(/"/gi,"&quot;"),a.replace(/\n/gi,"<br />\n")},OursoPhone.utils.interfaceLock=function(){$("body").addClass("locked")},OursoPhone.utils.interfaceRelease=function(){$("body").removeClass("locked")},OursoPhone.calcThumbsSize=function(a){var b,c,d,e,f={maxrows:OursoPhone.config.thumbs.rowspertrack,containerSelector:"#playlist",quantifierSelector:"trackbox",outerThumbSelector:".track img",innerThumbSelector:".track",marginWidthRule:'[data-display-mode="thumb"] .track .track-picture',fontSizeRule:'[data-display-mode="thumb"] .track .track-title'},g=$.extend(f,a),h=$(g.containerSelector),i=$(g.quantifierSelector),j=$(g.outerThumbSelector),k=$(g.innerThumbSelector),l=g.marginWidthRule,m=g.fontSizeRule,n=g.maxrows,o=i.length,p=0,q=document.styleSheets[document.styleSheets.length-1],e=$('<div id="scrollbar-checker"></div>');e.appendTo(h),e.width()>0&&h.width()!=e.width()?(b=e.width(),console.info("autogrow/autoshrink triggered",h.width(),e.width())):b=h.width(),e.remove(),c=b/Math.min(n,o);try{p=k.css("marginLeft").split("px")[0]- -k.css("marginRight").split("px")[0]- -(k.outerWidth()-j.width())}catch(r){return}for(var s=0;s<q.cssRules.length;s++)d=$.trim(q.cssRules[s].cssText.split("{")[0]),(d==l||d==m)&&(q.deleteRule(s),s--);q.insertRule(l+" { width: "+Math.floor(c-p)+"px }",q.cssRules.length-1),q.insertRule(m+" { font-size: "+(c/100).toFixed(2)+"rem }",q.cssRules.length-1)},OursoPhone.templates=[],TemplateStore.store["album-goback"]='  <div id="trackback"><a href="#" id="goback">&lt;--</a></div>',TemplateStore.store["album-item"]='  <div class="album">\n    <albumbox data-href="{album-url}" class="sound"\n      data-index="{album-index}"\n      data-url="{album-url}">\n      <div class="album-title" data-kind="{album-kind}">\n        {album-picture}\n        <span class="album-titlespan">{album-title}</span>\n        <span class="album-descspan">{album-description}</span>\n        <span class="album-genre">{album-genre}</span>\n        <span class="album-trackcount">{album-trackcount}</span>\n        <div style="clear:both"></div>\n        <span class="album-duration">{album-duration}</span>\n        <span class="album-createdat">{album-createdat}</span>\n        <div style="clear:both"></div>\n        <span class="album-taglist">{album-taglist}</span>\n      </div>\n      <div style="clear:both"></div>\n    </albumbox>\n  </div>',TemplateStore.store["album-no-picture"]='  <span class="album-nopicture"></span> ',TemplateStore.store["album-picture"]='  <img class="album-picture" src="{album-cover}" /> ',TemplateStore.store["comment-item"]='<li>\n  <a target="{target}" href="{href}">\n    <img class="user-avatarimg" src="{src}" alt="{alt}" title="{title}" /> \n  </a>\n  <span class="comment-text">{timestamp}{comment}</span>\n</li>',TemplateStore.store.index='<oursophone id="player">\n  <header id="player-header">\n    <div class="waveform-holder">\n      <div id="animbox"></div>\n      <div id="canvas-overlay"><img class="waveform-img loader" src="{pixel-trans}" /></div>\n    </div>\n    <div id="controls">\n      <div class="playback-controls">\n        <div class="player-button" href="#a:0:b:0" data-action="backward" data-index="0"><span class="player-click">&lt;&lt;</span></div>\n        <div class="player-button" href="#" data-action="play"><span class="player-click">play</span></div>\n        <div class="player-button" href="#" data-action="pause"><span class="player-click">pause</span></div>\n        <div class="player-button" href="#a:0:b:1" data-action="forward" data-index="0"><span class="player-click">&gt;&gt;</span></div>\n        <div style="clear:both"></div>\n      </div>\n      <div class="volume-control">\n        <label class="minus-button" data-volume-action="-">-</label>\n        <input type="range" data-action="setvolume" min="0" max="1" step="0.1" />\n        <label class="plus-button" data-volume-action="+">+</label>\n      </div>\n      <div class="search-button" title="Marre de GarD?">üîç</div>\n      <div class="comments-control">\n        <input type="checkbox" name="un-mute" id="un-mute" checked>\n        <label for="un-mute" class="unmute">\n          <img src="{pixel-trans}" class="mute-icon" alt="Mute_Icon.svg" title="Mute">\n        </label>\n        <label for="un-mute" class="mute">\n          <img src="{pixel-trans}" class="speak-icon" alt="Speaker_Icon.svg" title="Unmute (takes effect with the next song)">\n        </label>\n      </div>\n      <div id="player-state" data-state="zzz"></div>\n      <div style="clear:both"></div>\n    </div>\n    <div id="flex-box">\n      <div id="user-description"></div>\n      <div id="track-description"></div>\n      <div id="album-description" data-display-mode="list"></div>\n    </div>\n    <ol id="comments"></ol>\n  </header>\n  <div id="playlist" data-display-mode="thumb" data-tag-id="0" data-album-id="0" data-song-id="0" data-user=""></div>\n</oursophone>\n',TemplateStore.store["track-item"]='  <div class="track">\n    <trackbox data-href="{album-url}" class="sound" {data-attributes} data-index="{data-index}">\n      {track-picture}\n      <div class="track-title">\n        <span class="track-titlespan" data-download-url="{track-download-url}">{track-title}</span>\n        <span class="track-description">{track-description}</span>\n        <a class="track-permalinkurl" target="_blank" href="{track-permalinkurl}">permalink</a>\n        <span class="track-genre">{track-genre}</span>\n        <span class="track-duration">{track-duration}</span>\n        <span class="track-createdat">{track-createdat}</span>\n        <span class="track-taglist">{track-taglist}</span>\n        <span class="track-tracktype">{track-tracktype}</span>\n      </div>\n    </trackbox>\n  </div>',TemplateStore.store["track-no-picture"]='  <span class="track-nopicture"></span>',TemplateStore.store["track-picture"]='  <img class="track-picture" src="{track-artwork-url}" title="{track-title}" />',TemplateStore.store["user-item"]='  <div class="user">\n    <label for="user-description-toggler"></label>\n\n\n    <img class="user-avatarurl" src="{user-avatarurl}" />\n    <span class="user-id">{user-id}</span>\n    <span class="user-kind">{user-kind}</span>\n    <div class="user-stats">\n      <span class="user-fullname"><a target="_blank" class="user-permalinkurl" href="{user-permalinkurl}">{user-fullname}</a></span>\n      <span class="user-trackcount" title="tracks"><a href="#user:{user-id}">{user-trackcount}</a></span>\n      <span class="user-playlistcount" title="playlists" data-user-id="{user-id}">{user-playlistcount}</span>\n      <span class="user-followerscount" title="followers">{user-followerscount}</span>\n      <span class="user-followingcount" title="following">{user-followingcount}</span>\n    </div>\n    <span class="user-description">{user-description}</span>\n    <span class="user-website"><a class="user-websitetitle" target="_blank" href="{user-website}">{user-websitetitle}</a></span>\n  </div>',TemplateStore.store["view-mode-control"]='  <div class="display-mode-box">\n    <div class="display-mode-up" title="Back to Album list"></div>\n    <div class="display-mode-thumb" title="Display Tracks as thumbnails"></div>\n    <div class="display-mode-list" title="Display Tracks as list"></div>\n    <div class="display-mode-albumview" title="View Album infos"></div>\n    <div class="display-mode-trackview" title="View Track infos"></div>\n    <div class="display-mode-userview" title="View User infos"></div>\n  </div>';